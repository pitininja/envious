{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import 'dotenv/config';\nimport { type TObject, type Static } from '@sinclair/typebox';\nimport { Value } from '@sinclair/typebox/value';\nimport Os from 'os';\n\nexport const envious = <T extends TObject>(\n    schema: T,\n    defaultValues?: Static<T>\n): Static<T> => {\n    const parsed = Value.Convert(schema, process.env);\n    const errors = [...Value.Errors(schema, parsed)];\n    if (errors.length) {\n        const computedErrorMessages: Record<string, string[]> = {};\n        errors.forEach(({ path, message }) => {\n            const envVarName = path.replace(/^\\//, '');\n            if (!computedErrorMessages[envVarName]) {\n                computedErrorMessages[envVarName] = [];\n            }\n            computedErrorMessages[envVarName].push(message);\n        });\n        const errorTextParts: string[] = [\n            'Invalid environment variables',\n            ...Object.entries(computedErrorMessages).map(\n                ([varName, messages]) => `  ${varName} : ${messages.join(', ')}`\n            )\n        ];\n        throw new Error(errorTextParts.join(Os.EOL));\n    }\n    const env = Value.Cast(\n        {\n            ...schema,\n            additionalProperties: false\n        },\n        parsed\n    );\n    return {\n        ...defaultValues,\n        ...env\n    };\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAO;AAEP,mBAAsB;AACtB,gBAAe;AAER,IAAM,UAAU,CACnB,QACA,kBACY;AACZ,QAAM,SAAS,mBAAM,QAAQ,QAAQ,QAAQ,GAAG;AAChD,QAAM,SAAS,CAAC,GAAG,mBAAM,OAAO,QAAQ,MAAM,CAAC;AAC/C,MAAI,OAAO,QAAQ;AACf,UAAM,wBAAkD,CAAC;AACzD,WAAO,QAAQ,CAAC,EAAE,MAAM,QAAQ,MAAM;AAClC,YAAM,aAAa,KAAK,QAAQ,OAAO,EAAE;AACzC,UAAI,CAAC,sBAAsB,UAAU,GAAG;AACpC,8BAAsB,UAAU,IAAI,CAAC;AAAA,MACzC;AACA,4BAAsB,UAAU,EAAE,KAAK,OAAO;AAAA,IAClD,CAAC;AACD,UAAM,iBAA2B;AAAA,MAC7B;AAAA,MACA,GAAG,OAAO,QAAQ,qBAAqB,EAAE;AAAA,QACrC,CAAC,CAAC,SAAS,QAAQ,MAAM,KAAK,OAAO,MAAM,SAAS,KAAK,IAAI,CAAC;AAAA,MAClE;AAAA,IACJ;AACA,UAAM,IAAI,MAAM,eAAe,KAAK,UAAAA,QAAG,GAAG,CAAC;AAAA,EAC/C;AACA,QAAM,MAAM,mBAAM;AAAA,IACd;AAAA,MACI,GAAG;AAAA,MACH,sBAAsB;AAAA,IAC1B;AAAA,IACA;AAAA,EACJ;AACA,SAAO;AAAA,IACH,GAAG;AAAA,IACH,GAAG;AAAA,EACP;AACJ;","names":["Os"]}